geom_bar(stat = "identity", fill = "orange") +
labs(title = "Species Richness per Cluster",
x = "Cluster", y = "Richness") +
theme_minimal()
# ذخیره‌سازی
ggsave("richness.png", plot = p3, width = 6, height = 4, dpi = 300)
ggsave("richness.pdf", plot = p3, width = 6, height = 4)
library(dplyr)
library(vegan)
cluster_shannon <- full_metadata %>%
filter(!is.na(clone_size_ab)) %>%          # remove NAs
group_by(cluster) %>%                      # per cluster
summarise(
shannon = diversity(clone_size_ab, index = "shannon"),
simpson = diversity(clone_size_ab, index = "simpson"),
richness = specnumber(clone_size_ab)     # number of unique clones
)
library(ggplot2)
# تم عمومی: پس‌زمینه سفید و عنوان وسط‌چین
custom_theme <- theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold")  # عنوان وسط و بولد
)
# نمودار شانون
p1 <- ggplot(cluster_shannon, aes(x = cluster, y = shannon)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Shannon Diversity per Cluster",
x = "Cluster", y = "Shannon Index") +
custom_theme
ggsave("shannon_diversity.png", plot = p1, width = 6, height = 4, dpi = 300, bg = "white")
ggsave("shannon_diversity.pdf", plot = p1, width = 6, height = 4, bg = "white")
# نمودار سیمپسون
p2 <- ggplot(cluster_shannon, aes(x = cluster, y = simpson)) +
geom_bar(stat = "identity", fill = "darkgreen") +
labs(title = "Simpson Diversity per Cluster",
x = "Cluster", y = "Simpson Index") +
custom_theme
ggsave("simpson_diversity.png", plot = p2, width = 6, height = 4, dpi = 300, bg = "white")
ggsave("simpson_diversity.pdf", plot = p2, width = 6, height = 4, bg = "white")
# نمودار Richness
p3 <- ggplot(cluster_shannon, aes(x = cluster, y = richness)) +
geom_bar(stat = "identity", fill = "orange") +
labs(title = "Species Richness per Cluster",
x = "Cluster", y = "Richness") +
custom_theme
ggsave("richness.png", plot = p3, width = 6, height = 4, dpi = 300, bg = "white")
ggsave("richness.pdf", plot = p3, width = 6, height = 4, bg = "white")
library(dplyr)
library(vegan)
cluster_shannon <- full_metadata %>%
filter(!is.na(clone_size_ab)) %>%          # remove NAs
group_by(cluster) %>%                      # per cluster
summarise(
shannon = diversity(clone_size_ab, index = "shannon"),
simpson = diversity(clone_size_ab, index = "simpson"),
richness = specnumber(clone_size_ab)     # number of unique clones
)
library(ggplot2)
# تم عمومی: پس‌زمینه سفید، عنوان وسط، فونت و زاویه محور x
custom_theme <- theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),  # عنوان وسط و بولد
axis.text.x = element_text(size = 8, angle = 45, hjust = 1) # فونت کوچک و 45 درجه
)
# نمودار شانون
p1 <- ggplot(cluster_shannon, aes(x = cluster, y = shannon)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Shannon Diversity per Cluster",
x = "Cluster", y = "Shannon Index") +
custom_theme
ggsave("shannon_diversity.png", plot = p1, width = 8, height = 4, dpi = 300, bg = "white")
ggsave("shannon_diversity.pdf", plot = p1, width = 8, height = 4, bg = "white")
# نمودار سیمپسون
p2 <- ggplot(cluster_shannon, aes(x = cluster, y = simpson)) +
geom_bar(stat = "identity", fill = "darkgreen") +
labs(title = "Simpson Diversity per Cluster",
x = "Cluster", y = "Simpson Index") +
custom_theme
ggsave("simpson_diversity.png", plot = p2, width = 8, height = 4, dpi = 300, bg = "white")
ggsave("simpson_diversity.pdf", plot = p2, width = 8, height = 4, bg = "white")
# نمودار Richness
p3 <- ggplot(cluster_shannon, aes(x = cluster, y = richness)) +
geom_bar(stat = "identity", fill = "orange") +
labs(title = "Species Richness per Cluster",
x = "Cluster", y = "Richness") +
custom_theme
ggsave("richness.png", plot = p3, width = 8, height = 4, dpi = 300, bg = "white")
ggsave("richness.pdf", plot = p3, width = 8, height = 4, bg = "white")
library(dplyr)
library(vegan)
cluster_diversity <- full_metadata %>%
filter(!is.na(clone_size_ab)) %>%
group_by(cluster) %>%
summarise(
shannon = diversity(clone_size_ab, index = "shannon"),
simpson = diversity(clone_size_ab, index = "simpson"),
richness = specnumber(clone_size_ab),
.groups = "drop"
) %>%
# اضافه کردن شاخص نرمالایز شده
mutate(
shannon_norm = shannon / log(richness)
)
cluster_diversity
View(cluster_diversity)
View(cluster_diversity)
# 2. Normalized Shannon
p4 <- ggplot(cluster_diversity, aes(x = cluster, y = shannon_norm)) +
geom_bar(stat = "identity", fill = "dodgerblue") +
labs(title = "Normalized Shannon Diversity per Cluster",
x = "Cluster", y = "Normalized Shannon") +
custom_theme
ggsave("shannon_normalized.png", plot = p4, width = 8, height = 4, dpi = 300, bg = "white")
ggsave("shannon_normalized.pdf", plot = p4, width = 8, height = 4, bg = "white")
library(dplyr)
library(vegan)
cluster_shannon <- full_metadata %>%
filter(!is.na(clone_size_ab)) %>%          # remove NAs
group_by(cluster) %>%                      # per cluster
summarise(
shannon = diversity(clone_size_ab, index = "shannon"),
simpson = diversity(clone_size_ab, index = "simpson"),
richness = specnumber(clone_size_ab)     # number of unique clones
)
library(ggplot2)
# تم عمومی: پس‌زمینه سفید، عنوان وسط، فونت و زاویه محور x
custom_theme <- theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),  # عنوان وسط و بولد
axis.text.x = element_text(size = 8, angle = 45, hjust = 1) # فونت کوچک و 45 درجه
)
# نمودار شانون
p1 <- ggplot(cluster_shannon, aes(x = cluster, y = shannon)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Shannon Diversity per Cluster",
x = "Cluster", y = "Shannon Index") +
custom_theme
ggsave("shannon_diversity.png", plot = p1, width = 8, height = 4, dpi = 300, bg = "white")
ggsave("shannon_diversity.pdf", plot = p1, width = 8, height = 4, bg = "white")
# # نمودار سیمپسون
# p2 <- ggplot(cluster_shannon, aes(x = cluster, y = simpson)) +
#   geom_bar(stat = "identity", fill = "darkgreen") +
#   labs(title = "Simpson Diversity per Cluster",
#        x = "Cluster", y = "Simpson Index") +
#   custom_theme
#
# ggsave("simpson_diversity.png", plot = p2, width = 8, height = 4, dpi = 300, bg = "white")
# ggsave("simpson_diversity.pdf", plot = p2, width = 8, height = 4, bg = "white")
#
#
# # نمودار Richness
# p3 <- ggplot(cluster_shannon, aes(x = cluster, y = richness)) +
#   geom_bar(stat = "identity", fill = "orange") +
#   labs(title = "Species Richness per Cluster",
#        x = "Cluster", y = "Richness") +
#   custom_theme
#
# ggsave("richness.png", plot = p3, width = 8, height = 4, dpi = 300, bg = "white")
# ggsave("richness.pdf", plot = p3, width = 8, height = 4, bg = "white")
library(dplyr)
library(vegan)
cluster_diversity <- full_metadata %>%
filter(!is.na(clone_size_ab)) %>%
group_by(cluster) %>%
summarise(
shannon = diversity(clone_size_ab, index = "shannon"),
simpson = diversity(clone_size_ab, index = "simpson"),
richness = specnumber(clone_size_ab),
.groups = "drop"
) %>%
# اضافه کردن شاخص نرمالایز شده
mutate(
shannon_norm = shannon / log(richness)
)
cluster_diversity
# 2. Normalized Shannon
p4 <- ggplot(cluster_diversity, aes(x = cluster, y = shannon_norm)) +
geom_bar(stat = "identity", fill = "dodgerblue") +
labs(title = "Normalized Shannon Diversity per Cluster",
x = "Cluster", y = "Normalized Shannon") +
custom_theme
ggsave("shannon_normalized.png", plot = p4, width = 8, height = 4, dpi = 300, bg = "white")
ggsave("shannon_normalized.pdf", plot = p4, width = 8, height = 4, bg = "white")
load("C:/Esmaeil/CeliacProject/BackUp/Meta Data/MetaData_Esmaeil.Rdata")
setwd("C:/Esmaeil/CeliacProject/CeliacProject/Shanon")
library(dplyr)
library(vegan)
cluster_shannon <- full_metadata %>%
filter(!is.na(clone_size_ab)) %>%          # remove NAs
group_by(cluster) %>%                      # per cluster
summarise(
shannon = diversity(clone_size_ab, index = "shannon"),
simpson = diversity(clone_size_ab, index = "simpson"),
richness = specnumber(clone_size_ab)     # number of unique clones
)
library(ggplot2)
# تم عمومی: پس‌زمینه سفید، عنوان وسط، فونت و زاویه محور x
custom_theme <- theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),  # عنوان وسط و بولد
axis.text.x = element_text(size = 8, angle = 45, hjust = 1) # فونت کوچک و 45 درجه
)
# نمودار شانون
p1 <- ggplot(cluster_shannon, aes(x = cluster, y = shannon)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Shannon Diversity per Cluster",
x = "Cluster", y = "Shannon Index") +
custom_theme
ggsave("shannon_diversity.png", plot = p1, width = 8, height = 4, dpi = 300, bg = "white")
ggsave("shannon_diversity.pdf", plot = p1, width = 8, height = 4, bg = "white")
# # نمودار سیمپسون
# p2 <- ggplot(cluster_shannon, aes(x = cluster, y = simpson)) +
#   geom_bar(stat = "identity", fill = "darkgreen") +
#   labs(title = "Simpson Diversity per Cluster",
#        x = "Cluster", y = "Simpson Index") +
#   custom_theme
#
# ggsave("simpson_diversity.png", plot = p2, width = 8, height = 4, dpi = 300, bg = "white")
# ggsave("simpson_diversity.pdf", plot = p2, width = 8, height = 4, bg = "white")
#
#
# # نمودار Richness
# p3 <- ggplot(cluster_shannon, aes(x = cluster, y = richness)) +
#   geom_bar(stat = "identity", fill = "orange") +
#   labs(title = "Species Richness per Cluster",
#        x = "Cluster", y = "Richness") +
#   custom_theme
#
# ggsave("richness.png", plot = p3, width = 8, height = 4, dpi = 300, bg = "white")
# ggsave("richness.pdf", plot = p3, width = 8, height = 4, bg = "white")
library(dplyr)
library(vegan)
cluster_diversity <- full_metadata %>%
filter(!is.na(clone_size_ab)) %>%
group_by(cluster) %>%
summarise(
shannon = diversity(clone_size_ab, index = "shannon"),
simpson = diversity(clone_size_ab, index = "simpson"),
richness = specnumber(clone_size_ab),
.groups = "drop"
) %>%
mutate(
shannon_norm = shannon / log(richness)
)
cluster_diversity
# 2. Normalized Shannon
p4 <- ggplot(cluster_diversity, aes(x = cluster, y = shannon_norm)) +
geom_bar(stat = "identity", fill = "dodgerblue") +
labs(title = "Normalized Shannon Diversity per Cluster",
x = "Cluster", y = "Normalized Shannon") +
custom_theme
ggsave("shannon_normalized.png", plot = p4, width = 8, height = 4, dpi = 300, bg = "white")
ggsave("shannon_normalized.pdf", plot = p4, width = 8, height = 4, bg = "white")
target_clusters <- c(
"Plasma cells_1", "B cells_1", "B cells_2",
"B cells MZB1+", "Plasma cells_2", "Plasmablast",
"B cells BAFFR", "Tgd INSIG1+", "Tgd", "Tgd CD8+", "ILC2/ILC3", "ILC2/ILTi", "ILC1"
)
full_metadata <- full_metadata %>%
filter(!cluster %in% target_clusters)
load("C:/Esmaeil/CeliacProject/BackUp/Meta Data/MetaData_Esmaeil.Rdata")
target_clusters <- c(
"Plasma cells_1", "B cells_1", "B cells_2",
"B cells MZB1+", "Plasma cells_2", "Plasmablast",
"B cells BAFFR", "Tgd INSIG1+", "Tgd", "Tgd CD8+", "ILC2/ILC3", "ILC2/ILTi", "ILC1"
)
full_metadata <- full_metadata %>%
filter(!cluster %in% target_clusters)
unique(full_metadata$cluster)
library(dplyr)
library(vegan)
target_clusters <- c(
"Plasma cells_1", "B cells_1", "B cells_2",
"B cells MZB1+", "Plasma cells_2", "Plasmablast",
"B cells BAFFR", "Tgd INSIG1+", "Tgd", "Tgd CD8+", "ILC2/ILC3", "ILC2/ILTi", "ILC1"
)
full_metadata <- full_metadata %>%
filter(!cluster %in% target_clusters)
library(dplyr)
library(ggplot2)
library(vegan)
# ترتیب مرجع کل کلاسترها
ordered_celltypes_bycelltype <- c(
"CD4-CD8-", "Cyt. IEL", "Trm IEL", "IEL CCL4+", "nIEL",
"Prolif. IEL", "IEL GZMK+", "CD4-CD8- IL10 ICOS", "CD8 Mem", "CD8 Cyt.",
"CD8 Trm", "NK Tgd", "Tgd CD8+", "Tgd", "Tgd INSIG1+", "ILC1",
"ILC2/ILC3", "ILC2/ILTi", "Th", "Tregs", "Th1 Mem", "Th2/Tfh", "Th17",
"B cells MZB1+", "B cells BAFFR", "B cells_1", "B cells_2",
"Plasmablast", "Plasma cells_1", "Plasma cells_2",
"Macrophages", "DC", "Mast cells"
)
# فقط کلاسترهای موجود در داده
ordered_clusters <- ordered_celltypes_bycelltype[
ordered_celltypes_bycelltype %in% unique(full_metadata$cluster)
]
# محاسبه شاخص‌های تنوع
cluster_diversity <- full_metadata %>%
filter(!is.na(clone_size_ab)) %>%
group_by(cluster) %>%
summarise(
shannon = diversity(clone_size_ab, index = "shannon"),
simpson = diversity(clone_size_ab, index = "simpson"),
richness = specnumber(clone_size_ab),
.groups = "drop"
) %>%
mutate(
shannon_norm = shannon / log(richness),
# تبدیل cluster به factor با ترتیب دلخواه
cluster = factor(cluster, levels = ordered_clusters)
)
# تم عمومی ggplot
custom_theme <- theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1)
)
# نمودار شانون
p1 <- ggplot(cluster_diversity, aes(x = cluster, y = shannon)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Shannon Diversity per Cluster",
x = "Cluster", y = "Shannon Index") +
custom_theme
ggsave("shannon_diversity.png", plot = p1, width = 12, height = 5, dpi = 300, bg = "white")
ggsave("shannon_diversity.pdf", plot = p1, width = 12, height = 5, bg = "white")
# نمودار سیمپسون
p2 <- ggplot(cluster_diversity, aes(x = cluster, y = simpson)) +
geom_bar(stat = "identity", fill = "darkgreen") +
labs(title = "Simpson Diversity per Cluster",
x = "Cluster", y = "Simpson Index") +
custom_theme
ggsave("simpson_diversity.png", plot = p2, width = 12, height = 5, dpi = 300, bg = "white")
ggsave("simpson_diversity.pdf", plot = p2, width = 12, height = 5, bg = "white")
# نمودار Richness
p3 <- ggplot(cluster_diversity, aes(x = cluster, y = richness)) +
geom_bar(stat = "identity", fill = "orange") +
labs(title = "Species Richness per Cluster",
x = "Cluster", y = "Richness") +
custom_theme
ggsave("richness.png", plot = p3, width = 12, height = 5, dpi = 300, bg = "white")
ggsave("richness.pdf", plot = p3, width = 12, height = 5, bg = "white")
# نمودار Normalized Shannon
p4 <- ggplot(cluster_diversity, aes(x = cluster, y = shannon_norm)) +
geom_bar(stat = "identity", fill = "dodgerblue") +
labs(title = "Normalized Shannon Diversity per Cluster",
x = "Cluster", y = "Normalized Shannon") +
custom_theme
ggsave("shannon_normalized.png", plot = p4, width = 12, height = 5, dpi = 300, bg = "white")
ggsave("shannon_normalized.pdf", plot = p4, width = 12, height = 5, bg = "white")
library(dplyr)
library(vegan)
target_clusters <- c(
"Plasma cells_1", "B cells_1", "B cells_2",
"B cells MZB1+", "Plasma cells_2", "Plasmablast",
"B cells BAFFR", "Tgd INSIG1+", "Tgd", "Tgd CD8+", "ILC2/ILC3", "ILC2/ILTi", "ILC1"
)
full_metadata <- full_metadata %>%
filter(!cluster %in% target_clusters)
library(dplyr)
library(ggplot2)
library(vegan)
# ترتیب مرجع کل کلاسترها
ordered_celltypes_bycelltype <- c(
"CD4-CD8-", "Cyt. IEL", "Trm IEL", "IEL CCL4+", "nIEL",
"Prolif. IEL", "IEL GZMK+", "CD4-CD8- IL10 ICOS", "CD8 Mem", "CD8 Cyt.",
"CD8 Trm", "NK Tgd", "Tgd CD8+", "Tgd", "Tgd INSIG1+", "ILC1",
"ILC2/ILC3", "ILC2/ILTi", "Th", "Tregs", "Th1 Mem", "Th2/Tfh", "Th17",
"B cells MZB1+", "B cells BAFFR", "B cells_1", "B cells_2",
"Plasmablast", "Plasma cells_1", "Plasma cells_2",
"Macrophages", "DC", "Mast cells"
)
# فقط کلاسترهای موجود در داده
ordered_clusters <- ordered_celltypes_bycelltype[
ordered_celltypes_bycelltype %in% unique(full_metadata$cluster)
]
# محاسبه شاخص‌های تنوع
cluster_diversity <- full_metadata %>%
filter(!is.na(clone_size_ab)) %>%
group_by(cluster) %>%
summarise(
shannon = diversity(clone_size_ab, index = "shannon"),
simpson = diversity(clone_size_ab, index = "simpson"),
richness = specnumber(clone_size_ab),
.groups = "drop"
) %>%
mutate(
shannon_norm = shannon / log(richness),
# تبدیل cluster به factor با ترتیب دلخواه
cluster = factor(cluster, levels = ordered_clusters)
)
# تم عمومی ggplot
custom_theme <- theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1)
)
# نمودار شانون
p1 <- ggplot(cluster_diversity, aes(x = cluster, y = shannon)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Shannon Diversity per Cluster",
x = "Cluster", y = "Shannon Index") +
custom_theme
ggsave("shannon_diversity.png", plot = p1, width = 12, height = 5, dpi = 300, bg = "white")
ggsave("shannon_diversity.pdf", plot = p1, width = 12, height = 5, bg = "white")
# # نمودار سیمپسون
# p2 <- ggplot(cluster_diversity, aes(x = cluster, y = simpson)) +
#   geom_bar(stat = "identity", fill = "darkgreen") +
#   labs(title = "Simpson Diversity per Cluster",
#        x = "Cluster", y = "Simpson Index") +
#   custom_theme
#
# ggsave("simpson_diversity.png", plot = p2, width = 12, height = 5, dpi = 300, bg = "white")
# ggsave("simpson_diversity.pdf", plot = p2, width = 12, height = 5, bg = "white")
#
# # نمودار Richness
# p3 <- ggplot(cluster_diversity, aes(x = cluster, y = richness)) +
#   geom_bar(stat = "identity", fill = "orange") +
#   labs(title = "Species Richness per Cluster",
#        x = "Cluster", y = "Richness") +
#   custom_theme
#
# ggsave("richness.png", plot = p3, width = 12, height = 5, dpi = 300, bg = "white")
# ggsave("richness.pdf", plot = p3, width = 12, height = 5, bg = "white")
# نمودار Normalized Shannon
p4 <- ggplot(cluster_diversity, aes(x = cluster, y = shannon_norm)) +
geom_bar(stat = "identity", fill = "dodgerblue") +
labs(title = "Normalized Shannon Diversity per Cluster",
x = "Cluster", y = "Normalized Shannon") +
custom_theme
ggsave("shannon_normalized.png", plot = p4, width = 12, height = 5, dpi = 300, bg = "white")
ggsave("shannon_normalized.pdf", plot = p4, width = 12, height = 5, bg = "white")
library(dplyr)
library(vegan)
target_clusters <- c(
"Plasma cells_1", "B cells_1", "B cells_2",
"B cells MZB1+", "Plasma cells_2", "Plasmablast",
"B cells BAFFR", "Tgd INSIG1+", "Tgd", "Tgd CD8+", "ILC2/ILC3", "ILC2/ILTi", "ILC1"
)
full_metadata <- full_metadata %>%
filter(!cluster %in% target_clusters)
library(dplyr)
library(ggplot2)
library(vegan)
# ترتیب مرجع کل کلاسترها
ordered_celltypes_bycelltype <- c(
"CD4-CD8-", "Cyt. IEL", "Trm IEL", "IEL CCL4+", "nIEL",
"Prolif. IEL", "IEL GZMK+", "CD4-CD8- IL10 ICOS", "CD8 Mem", "CD8 Cyt.",
"CD8 Trm", "NK Tgd", "Tgd CD8+", "Tgd", "Tgd INSIG1+", "ILC1",
"ILC2/ILC3", "ILC2/ILTi", "Th", "Tregs", "Th1 Mem", "Th2/Tfh", "Th17",
"B cells MZB1+", "B cells BAFFR", "B cells_1", "B cells_2",
"Plasmablast", "Plasma cells_1", "Plasma cells_2",
"Macrophages", "DC", "Mast cells"
)
# فقط کلاسترهای موجود در داده
ordered_clusters <- ordered_celltypes_bycelltype[
ordered_celltypes_bycelltype %in% unique(full_metadata$cluster)
]
# محاسبه شاخص‌های تنوع
cluster_diversity <- full_metadata %>%
filter(!is.na(clone_size_ab)) %>%
group_by(cluster) %>%
summarise(
shannon = diversity(clone_size_ab, index = "shannon"),
simpson = diversity(clone_size_ab, index = "simpson"),
richness = specnumber(clone_size_ab),
.groups = "drop"
) %>%
mutate(
shannon_norm = shannon / log(richness),
# تبدیل cluster به factor با ترتیب دلخواه
cluster = factor(cluster, levels = ordered_clusters)
)
# تم عمومی ggplot
custom_theme <- theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1)
)
# نمودار شانون
p1 <- ggplot(cluster_diversity, aes(x = cluster, y = shannon)) +
geom_bar(stat = "identity", fill = "steelblue") +
labs(title = "Shannon Diversity per Cluster",
x = "Cluster", y = "Shannon Index") +
custom_theme
ggsave("shannon_diversity.png", plot = p1, width = 8, height = 5, dpi = 300, bg = "white")
ggsave("shannon_diversity.pdf", plot = p1, width = 8, height = 5, bg = "white")
# # نمودار سیمپسون
# p2 <- ggplot(cluster_diversity, aes(x = cluster, y = simpson)) +
#   geom_bar(stat = "identity", fill = "darkgreen") +
#   labs(title = "Simpson Diversity per Cluster",
#        x = "Cluster", y = "Simpson Index") +
#   custom_theme
#
# ggsave("simpson_diversity.png", plot = p2, width = 12, height = 5, dpi = 300, bg = "white")
# ggsave("simpson_diversity.pdf", plot = p2, width = 12, height = 5, bg = "white")
#
# # نمودار Richness
# p3 <- ggplot(cluster_diversity, aes(x = cluster, y = richness)) +
#   geom_bar(stat = "identity", fill = "orange") +
#   labs(title = "Species Richness per Cluster",
#        x = "Cluster", y = "Richness") +
#   custom_theme
#
# ggsave("richness.png", plot = p3, width = 12, height = 5, dpi = 300, bg = "white")
# ggsave("richness.pdf", plot = p3, width = 12, height = 5, bg = "white")
# نمودار Normalized Shannon
p4 <- ggplot(cluster_diversity, aes(x = cluster, y = shannon_norm)) +
geom_bar(stat = "identity", fill = "dodgerblue") +
labs(title = "Normalized Shannon Diversity per Cluster",
x = "Cluster", y = "Normalized Shannon") +
custom_theme
ggsave("shannon_normalized.png", plot = p4, width = 8, height = 5, dpi = 300, bg = "white")
ggsave("shannon_normalized.pdf", plot = p4, width = 8, height = 5, bg = "white")
