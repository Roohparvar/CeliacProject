receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
agg_png(filename = png_filename, width = 2000, height = 1600, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 1.5,
cex.axis = 1.5,
cex.main = 2,
cex.lab = 1.8)
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
png(filename = png_filename, width = 800, height = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2)
dev.off()
}
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
png(filename = png_filename, width = 800, height = 600, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2)
dev.off()
}
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
png(filename = png_filename, width = 2000, height = 600, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2)
dev.off()
}
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
png(filename = png_filename, width = 2000, height = 1000, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2)
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
png(filename = png_filename, width = 2000, height = 1000, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.7)  # کوچک‌تر کردن فونت نام کلاسترها
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
png(filename = png_filename, width = 2000, height = 1000, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.7,
cex.axis = 0.5 )
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
png(filename = png_filename, width = 2000, height = 1000, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.4,
cex.axis = 0.5 )
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
png(filename = png_filename, width = 2000, height = 1000, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3 )
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
png(filename = png_filename, width = 2000, height = 1000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3 )
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
png(filename = png_filename, width = 2000, height = 1000, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3 )
dev.off()
}
install.packages("ragg")
library(ragg)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
agg_png(filename = png_filename, width = 2000, height = 1000, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3 )
dev.off()
}
library(ragg)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
agg_png(filename = png_filename, width = 2000, height = 1000, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3 )
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2 با ylim مناسب
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
# پیدا کردن بیشترین مقدار برای محور y با کمی فاصله (مثلاً 10% بیشتر)
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 2000, height = 1000, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3,
ylim = c(0, ylim_max))  # تنظیم ylim دقیق و کمی بیشتر از بیشترین مقدار
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2 با ylim مناسب
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
# پیدا کردن بیشترین مقدار برای محور y با کمی فاصله (مثلاً 10% بیشتر)
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3,
ylim = c(0, ylim_max))  # تنظیم ylim دقیق و کمی بیشتر از بیشترین مقدار
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2 با ylim مناسب
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
# پیدا کردن بیشترین مقدار برای محور y با کمی فاصله (مثلاً 10% بیشتر)
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 2000, height = 1000, res = 300)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3,
ylim = c(0, ylim_max))  # تنظیم ylim دقیق و کمی بیشتر از بیشترین مقدار
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2 با ylim مناسب
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
# پیدا کردن بیشترین مقدار برای محور y با کمی فاصله (مثلاً 10% بیشتر)
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3,
ylim = c(0, ylim_max))  # تنظیم ylim دقیق و کمی بیشتر از بیشترین مقدار
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2 با ylim مناسب
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
# پیدا کردن بیشترین مقدار برای محور y با کمی فاصله (مثلاً 10% بیشتر)
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 800)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3,
ylim = c(0, ylim_max))  # تنظیم ylim دقیق و کمی بیشتر از بیشترین مقدار
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2 با ylim مناسب
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
# پیدا کردن بیشترین مقدار برای محور y با کمی فاصله (مثلاً 10% بیشتر)
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 1200)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3,
ylim = c(0, ylim_max))  # تنظیم ylim دقیق و کمی بیشتر از بیشترین مقدار
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2 با ylim مناسب
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
# پیدا کردن بیشترین مقدار برای محور y با کمی فاصله (مثلاً 10% بیشتر)
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 1000)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3,
ylim = c(0, ylim_max))  # تنظیم ylim دقیق و کمی بیشتر از بیشترین مقدار
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2 با ylim مناسب
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
# پیدا کردن بیشترین مقدار برای محور y با کمی فاصله (مثلاً 10% بیشتر)
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3,
ylim = c(0, ylim_max))  # تنظیم ylim دقیق و کمی بیشتر از بیشترین مقدار
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2 با ylim مناسب و اضافه کردن خط محور x
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3,
ylim = c(0, ylim_max))
abline(h = 0, col = "black", lwd = 1)  # این خط محور افقی را اضافه می‌کند
dev.off()
}
# حذف سطرهایی که imm_receptor2 خالی هستند (NA یا "")
filtered_data <- full_metadata[!is.na(full_metadata$imm_receptor2) & full_metadata$imm_receptor2 != "", ]
# ساخت جدول شمارش
table_data <- table(filtered_data$cluster, filtered_data$imm_receptor2)
count_df <- as.data.frame.matrix(table_data)
# نمایش جدول شمارش
print(count_df)
# رسم بارپلات برای هر imm_receptor2 با ylim مناسب
receptor_types <- colnames(count_df)
for (receptor in receptor_types) {
png_filename <- paste0("barplot_", gsub(" ", "_", receptor), ".png")
# پیدا کردن بیشترین مقدار برای محور y با کمی فاصله (مثلاً 10% بیشتر)
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", receptor, "across clusters"),
xlab = "Clusters",
ylab = "Count",
col = "steelblue",
las = 2,
cex.names = 0.3,
cex.axis = 0.3,
ylim = c(0, ylim_max))  # تنظیم ylim دقیق و کمی بیشتر از بیشترین مقدار
dev.off()
}
