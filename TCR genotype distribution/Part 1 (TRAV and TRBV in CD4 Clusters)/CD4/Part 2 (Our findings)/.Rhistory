TRAV == "TRAV13-1" & TRBV == "TRBV20-1" ~ "TRAV13-1 + TRBV20-1",
TRAV == "TRAV13-1" ~ "TRAV13-1",
TRBV == "TRBV20-1" ~ "TRBV20-1",
TRUE ~ NA_character_
)) %>%
filter(!is.na(tcr_group))
group_counts <- selected_data %>%
group_by(cluster, tcr_group) %>%
summarise(count = n(), .groups = "drop")
bar_data <- group_counts %>%
left_join(total_counts, by = "cluster") %>%
mutate(freq = count / total_cells * 100)
# تنظیم ترتیب لجند
bar_data$tcr_group <- factor(bar_data$tcr_group, levels = c("TRAV13-1 + TRBV20-1", "TRAV13-1", "TRBV20-1"))
tcr_colors <- c(
"TRAV13-1 + TRBV20-1" = "#ae1e28",
"TRAV13-1" = "#f78454",
"TRBV20-1" = "#ffd8c5"
)
bar_plot <- ggplot(bar_data, aes(x = cluster, y = freq, fill = tcr_group)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_manual(values = tcr_colors, name = "TCR Group") +
scale_y_continuous(labels = label_percent(scale = 1)) +
labs(x = "Cluster", y = "Percentage of Cells",
title = "Proportion of Specific TCR Gene Combinations Across CD4 Clusters") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(
"TCR_barplot_by_cluster_selected_groups.png",
plot = bar_plot,
width = 8,
height = 6,
dpi = 300,
bg = "white"
)
library(ggplot2)
library(dplyr)
library(scales)
# Desired cluster order
cluster_order <- c("Th1 Mem", "Th17", "Th2/Tfh", "Tregs")
full_metadata$cluster <- factor(full_metadata$cluster, levels = cluster_order)
full_metadata <- full_metadata %>% filter(!is.na(cluster))
filtered_data <- full_metadata %>%
filter(!is.na(TRAV) & TRAV != "" & !is.na(TRBV) & TRBV != "")
total_counts <- filtered_data %>%
group_by(cluster) %>%
summarise(total_cells = n())
selected_data <- filtered_data %>%
mutate(tcr_group = case_when(
TRAV == "TRAV13-1" & TRBV == "TRBV20-1" ~ "TRAV13-1 + TRBV20-1",
TRAV == "TRAV13-1" ~ "TRAV13-1",
TRBV == "TRBV20-1" ~ "TRBV20-1",
TRUE ~ NA_character_
)) %>%
filter(!is.na(tcr_group))
group_counts <- selected_data %>%
group_by(cluster, tcr_group) %>%
summarise(count = n(), .groups = "drop")
bar_data <- group_counts %>%
left_join(total_counts, by = "cluster") %>%
mutate(freq = count / total_cells * 100)
# تنظیم ترتیب لجند
bar_data$tcr_group <- factor(bar_data$tcr_group, levels = c("TRAV13-1 + TRBV20-1", "TRAV13-1", "TRBV20-1"))
tcr_colors <- c(
"TRAV13-1 + TRBV20-1" = "#003f5c",  # آبی تیره دانشگاهی
"TRAV13-1"             = "#7a5195",  # بنفش ملایم و حرفه‌ای
"TRBV20-1"             = "#ef5675"   # قرمز صورتی ملایم و شفاف
)
bar_plot <- ggplot(bar_data, aes(x = cluster, y = freq, fill = tcr_group)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_manual(values = tcr_colors, name = "TCR Group") +
scale_y_continuous(labels = label_percent(scale = 1)) +
labs(x = "Cluster", y = "Percentage of Cells",
title = "Proportion of Specific TCR Gene Combinations Across CD4 Clusters") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(
"TCR_barplot_by_cluster_selected_groups.png",
plot = bar_plot,
width = 8,
height = 6,
dpi = 300,
bg = "white"
)
library(ggplot2)
library(dplyr)
library(scales)
# Desired cluster order
cluster_order <- c("Th1 Mem", "Th17", "Th2/Tfh", "Tregs")
full_metadata$cluster <- factor(full_metadata$cluster, levels = cluster_order)
full_metadata <- full_metadata %>% filter(!is.na(cluster))
filtered_data <- full_metadata %>%
filter(!is.na(TRAV) & TRAV != "" & !is.na(TRBV) & TRBV != "")
total_counts <- filtered_data %>%
group_by(cluster) %>%
summarise(total_cells = n())
selected_data <- filtered_data %>%
mutate(tcr_group = case_when(
TRAV == "TRAV13-1" & TRBV == "TRBV20-1" ~ "TRAV13-1 + TRBV20-1",
TRAV == "TRAV13-1" ~ "TRAV13-1",
TRBV == "TRBV20-1" ~ "TRBV20-1",
TRUE ~ NA_character_
)) %>%
filter(!is.na(tcr_group))
group_counts <- selected_data %>%
group_by(cluster, tcr_group) %>%
summarise(count = n(), .groups = "drop")
bar_data <- group_counts %>%
left_join(total_counts, by = "cluster") %>%
mutate(freq = count / total_cells * 100)
# تنظیم ترتیب لجند
bar_data$tcr_group <- factor(bar_data$tcr_group, levels = c("TRAV13-1 + TRBV20-1", "TRAV13-1", "TRBV20-1"))
tcr_colors <- c(
"TRAV13-1 + TRBV20-1" = "#000000",  # سیاه خالص
"TRAV13-1"             = "#333333",  # خاکستری خیلی تیره
"TRBV20-1"             = "#666666"   # خاکستری تیره‌تر ولی روشن‌تر از قبلی
)
bar_plot <- ggplot(bar_data, aes(x = cluster, y = freq, fill = tcr_group)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_manual(values = tcr_colors, name = "TCR Group") +
scale_y_continuous(labels = label_percent(scale = 1)) +
labs(x = "Cluster", y = "Percentage of Cells",
title = "Proportion of Specific TCR Gene Combinations Across CD4 Clusters") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(
"TCR_barplot_by_cluster_selected_groups.png",
plot = bar_plot,
width = 8,
height = 6,
dpi = 300,
bg = "white"
)
library(ggplot2)
library(dplyr)
library(scales)
# Desired cluster order
cluster_order <- c("Th1 Mem", "Th17", "Th2/Tfh", "Tregs")
full_metadata$cluster <- factor(full_metadata$cluster, levels = cluster_order)
full_metadata <- full_metadata %>% filter(!is.na(cluster))
filtered_data <- full_metadata %>%
filter(!is.na(TRAV) & TRAV != "" & !is.na(TRBV) & TRBV != "")
total_counts <- filtered_data %>%
group_by(cluster) %>%
summarise(total_cells = n())
selected_data <- filtered_data %>%
mutate(tcr_group = case_when(
TRAV == "TRAV13-1" & TRBV == "TRBV20-1" ~ "TRAV13-1 + TRBV20-1",
TRAV == "TRAV13-1" ~ "TRAV13-1",
TRBV == "TRBV20-1" ~ "TRBV20-1",
TRUE ~ NA_character_
)) %>%
filter(!is.na(tcr_group))
group_counts <- selected_data %>%
group_by(cluster, tcr_group) %>%
summarise(count = n(), .groups = "drop")
bar_data <- group_counts %>%
left_join(total_counts, by = "cluster") %>%
mutate(freq = count / total_cells * 100)
# تنظیم ترتیب لجند
bar_data$tcr_group <- factor(bar_data$tcr_group, levels = c("TRAV13-1 + TRBV20-1", "TRAV13-1", "TRBV20-1"))
tcr_colors <- c(
"TRAV13-1 + TRBV20-1" = "#2f2f2f",  # خاکستری خیلی تیره
"TRAV13-1"             = "#595959",  # خاکستری تیره متوسط
"TRBV20-1"             = "#7f7f7f"   # خاکستری متوسط به روشن
)
bar_plot <- ggplot(bar_data, aes(x = cluster, y = freq, fill = tcr_group)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_manual(values = tcr_colors, name = "TCR Group") +
scale_y_continuous(labels = label_percent(scale = 1)) +
labs(x = "Cluster", y = "Percentage of Cells",
title = "Proportion of Specific TCR Gene Combinations Across CD4 Clusters") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(
"TCR_barplot_by_cluster_selected_groups.png",
plot = bar_plot,
width = 8,
height = 6,
dpi = 300,
bg = "white"
)
library(ggplot2)
library(dplyr)
library(scales)
# Desired cluster order
cluster_order <- c("Th1 Mem", "Th17", "Th2/Tfh", "Tregs")
full_metadata$cluster <- factor(full_metadata$cluster, levels = cluster_order)
full_metadata <- full_metadata %>% filter(!is.na(cluster))
filtered_data <- full_metadata %>%
filter(!is.na(TRAV) & TRAV != "" & !is.na(TRBV) & TRBV != "")
total_counts <- filtered_data %>%
group_by(cluster) %>%
summarise(total_cells = n())
selected_data <- filtered_data %>%
mutate(tcr_group = case_when(
TRAV == "TRAV13-1" & TRBV == "TRBV20-1" ~ "TRAV13-1 + TRBV20-1",
TRAV == "TRAV13-1" ~ "TRAV13-1",
TRBV == "TRBV20-1" ~ "TRBV20-1",
TRUE ~ NA_character_
)) %>%
filter(!is.na(tcr_group))
group_counts <- selected_data %>%
group_by(cluster, tcr_group) %>%
summarise(count = n(), .groups = "drop")
bar_data <- group_counts %>%
left_join(total_counts, by = "cluster") %>%
mutate(freq = count / total_cells * 100)
# تنظیم ترتیب لجند
bar_data$tcr_group <- factor(bar_data$tcr_group, levels = c("TRAV13-1 + TRBV20-1", "TRAV13-1", "TRBV20-1"))
tcr_colors <- c(
"TRAV13-1 + TRBV20-1" = "#4a4a4a",  # خاکستری تیره
"TRAV13-1"             = "#7a7a7a",  # خاکستری متوسط
"TRBV20-1"             = "#a0a0a0"   # خاکستری روشن
)
bar_plot <- ggplot(bar_data, aes(x = cluster, y = freq, fill = tcr_group)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_manual(values = tcr_colors, name = "TCR Group") +
scale_y_continuous(labels = label_percent(scale = 1)) +
labs(x = "Cluster", y = "Percentage of Cells",
title = "Proportion of Specific TCR Gene Combinations Across CD4 Clusters") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(
"TCR_barplot_by_cluster_selected_groups.png",
plot = bar_plot,
width = 8,
height = 6,
dpi = 300,
bg = "white"
)
library(ggplot2)
library(dplyr)
library(scales)
# Desired cluster order
cluster_order <- c("Th1 Mem", "Th17", "Th2/Tfh", "Tregs")
full_metadata$cluster <- factor(full_metadata$cluster, levels = cluster_order)
full_metadata <- full_metadata %>% filter(!is.na(cluster))
filtered_data <- full_metadata %>%
filter(!is.na(TRAV) & TRAV != "" & !is.na(TRBV) & TRBV != "")
total_counts <- filtered_data %>%
group_by(cluster) %>%
summarise(total_cells = n())
selected_data <- filtered_data %>%
mutate(tcr_group = case_when(
TRAV == "TRAV13-1" & TRBV == "TRBV20-1" ~ "TRAV13-1 + TRBV20-1",
TRAV == "TRAV13-1" ~ "TRAV13-1",
TRBV == "TRBV20-1" ~ "TRBV20-1",
TRUE ~ NA_character_
)) %>%
filter(!is.na(tcr_group))
group_counts <- selected_data %>%
group_by(cluster, tcr_group) %>%
summarise(count = n(), .groups = "drop")
bar_data <- group_counts %>%
left_join(total_counts, by = "cluster") %>%
mutate(freq = count / total_cells * 100)
# تنظیم ترتیب لجند
bar_data$tcr_group <- factor(bar_data$tcr_group, levels = c("TRAV13-1 + TRBV20-1", "TRAV13-1", "TRBV20-1"))
tcr_colors <- c(
"TRAV13-1 + TRBV20-1" = "#003049",  # آبی تیره (navy-ish)
"TRAV13-1"             = "#7b2d26",  # قهوه‌ای تیره متمایل به قرمز
"TRBV20-1"             = "#9a031e"   # قرمز تیره شرابی
)
bar_plot <- ggplot(bar_data, aes(x = cluster, y = freq, fill = tcr_group)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_manual(values = tcr_colors, name = "TCR Group") +
scale_y_continuous(labels = label_percent(scale = 1)) +
labs(x = "Cluster", y = "Percentage of Cells",
title = "Proportion of Specific TCR Gene Combinations Across CD4 Clusters") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(
"TCR_barplot_by_cluster_selected_groups.png",
plot = bar_plot,
width = 8,
height = 6,
dpi = 300,
bg = "white"
)
library(ggplot2)
library(dplyr)
library(scales)
# Desired cluster order
cluster_order <- c("Th1 Mem", "Th17", "Th2/Tfh", "Tregs")
full_metadata$cluster <- factor(full_metadata$cluster, levels = cluster_order)
full_metadata <- full_metadata %>% filter(!is.na(cluster))
filtered_data <- full_metadata %>%
filter(!is.na(TRAV) & TRAV != "" & !is.na(TRBV) & TRBV != "")
total_counts <- filtered_data %>%
group_by(cluster) %>%
summarise(total_cells = n())
selected_data <- filtered_data %>%
mutate(tcr_group = case_when(
TRAV == "TRAV13-1" & TRBV == "TRBV20-1" ~ "TRAV13-1 + TRBV20-1",
TRAV == "TRAV13-1" ~ "TRAV13-1",
TRBV == "TRBV20-1" ~ "TRBV20-1",
TRUE ~ NA_character_
)) %>%
filter(!is.na(tcr_group))
group_counts <- selected_data %>%
group_by(cluster, tcr_group) %>%
summarise(count = n(), .groups = "drop")
bar_data <- group_counts %>%
left_join(total_counts, by = "cluster") %>%
mutate(freq = count / total_cells * 100)
# تنظیم ترتیب لجند
bar_data$tcr_group <- factor(bar_data$tcr_group, levels = c("TRAV13-1 + TRBV20-1", "TRAV13-1", "TRBV20-1"))
tcr_colors <- c(
"TRAV13-1 + TRBV20-1" = "#001f4d",  # آبی خیلی تیره
"TRAV13-1"             = "#3a0070",  # بنفش تیره
"TRBV20-1"             = "#0d0030"   # سرمه‌ای خیلی تیره (مشکی مایل به آبی)
)
bar_plot <- ggplot(bar_data, aes(x = cluster, y = freq, fill = tcr_group)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_manual(values = tcr_colors, name = "TCR Group") +
scale_y_continuous(labels = label_percent(scale = 1)) +
labs(x = "Cluster", y = "Percentage of Cells",
title = "Proportion of Specific TCR Gene Combinations Across CD4 Clusters") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(
"TCR_barplot_by_cluster_selected_groups.png",
plot = bar_plot,
width = 8,
height = 6,
dpi = 300,
bg = "white"
)
library(ggplot2)
library(dplyr)
library(scales)
# Desired cluster order
cluster_order <- c("Th1 Mem", "Th17", "Th2/Tfh", "Tregs")
full_metadata$cluster <- factor(full_metadata$cluster, levels = cluster_order)
full_metadata <- full_metadata %>% filter(!is.na(cluster))
filtered_data <- full_metadata %>%
filter(!is.na(TRAV) & TRAV != "" & !is.na(TRBV) & TRBV != "")
total_counts <- filtered_data %>%
group_by(cluster) %>%
summarise(total_cells = n())
selected_data <- filtered_data %>%
mutate(tcr_group = case_when(
TRAV == "TRAV13-1" & TRBV == "TRBV20-1" ~ "TRAV13-1 + TRBV20-1",
TRAV == "TRAV13-1" ~ "TRAV13-1",
TRBV == "TRBV20-1" ~ "TRBV20-1",
TRUE ~ NA_character_
)) %>%
filter(!is.na(tcr_group))
group_counts <- selected_data %>%
group_by(cluster, tcr_group) %>%
summarise(count = n(), .groups = "drop")
bar_data <- group_counts %>%
left_join(total_counts, by = "cluster") %>%
mutate(freq = count / total_cells * 100)
# تنظیم ترتیب لجند
bar_data$tcr_group <- factor(bar_data$tcr_group, levels = c("TRAV13-1 + TRBV20-1", "TRAV13-1", "TRBV20-1"))
tcr_colors <- c(
"TRAV13-1 + TRBV20-1" = "#cfe3f6",  # آبی خیلی تیره
"TRAV13-1"             = "#5eaada",  # بنفش تیره
"TRBV20-1"             = "#1367b7"   # سرمه‌ای خیلی تیره (مشکی مایل به آبی)
)
bar_plot <- ggplot(bar_data, aes(x = cluster, y = freq, fill = tcr_group)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_manual(values = tcr_colors, name = "TCR Group") +
scale_y_continuous(labels = label_percent(scale = 1)) +
labs(x = "Cluster", y = "Percentage of Cells",
title = "Proportion of Specific TCR Gene Combinations Across CD4 Clusters") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(
"TCR_barplot_by_cluster_selected_groups.png",
plot = bar_plot,
width = 8,
height = 6,
dpi = 300,
bg = "white"
)
library(ggplot2)
library(dplyr)
library(scales)
# Desired cluster order
cluster_order <- c("Th1 Mem", "Th17", "Th2/Tfh", "Tregs")
full_metadata$cluster <- factor(full_metadata$cluster, levels = cluster_order)
full_metadata <- full_metadata %>% filter(!is.na(cluster))
filtered_data <- full_metadata %>%
filter(!is.na(TRAV) & TRAV != "" & !is.na(TRBV) & TRBV != "")
total_counts <- filtered_data %>%
group_by(cluster) %>%
summarise(total_cells = n())
selected_data <- filtered_data %>%
mutate(tcr_group = case_when(
TRAV == "TRAV13-1" & TRBV == "TRBV20-1" ~ "TRAV13-1 + TRBV20-1",
TRAV == "TRAV13-1" ~ "TRAV13-1",
TRBV == "TRBV20-1" ~ "TRBV20-1",
TRUE ~ NA_character_
)) %>%
filter(!is.na(tcr_group))
group_counts <- selected_data %>%
group_by(cluster, tcr_group) %>%
summarise(count = n(), .groups = "drop")
bar_data <- group_counts %>%
left_join(total_counts, by = "cluster") %>%
mutate(freq = count / total_cells * 100)
# تنظیم ترتیب لجند
bar_data$tcr_group <- factor(bar_data$tcr_group, levels = c("TRAV13-1 + TRBV20-1", "TRAV13-1", "TRBV20-1"))
tcr_colors <- c(
"TRAV13-1 + TRBV20-1" = "#cfe3f6",  # آبی خیلی تیره
"TRAV13-1"             = "#5eaada",  # بنفش تیره
"TRBV20-1"             = "#136760"   # سرمه‌ای خیلی تیره (مشکی مایل به آبی)
)
bar_plot <- ggplot(bar_data, aes(x = cluster, y = freq, fill = tcr_group)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_manual(values = tcr_colors, name = "TCR Group") +
scale_y_continuous(labels = label_percent(scale = 1)) +
labs(x = "Cluster", y = "Percentage of Cells",
title = "Proportion of Specific TCR Gene Combinations Across CD4 Clusters") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(
"TCR_barplot_by_cluster_selected_groups.png",
plot = bar_plot,
width = 8,
height = 6,
dpi = 300,
bg = "white"
)
library(ggplot2)
library(dplyr)
library(scales)
# Desired cluster order
cluster_order <- c("Th1 Mem", "Th17", "Th2/Tfh", "Tregs")
full_metadata$cluster <- factor(full_metadata$cluster, levels = cluster_order)
full_metadata <- full_metadata %>% filter(!is.na(cluster))
filtered_data <- full_metadata %>%
filter(!is.na(TRAV) & TRAV != "" & !is.na(TRBV) & TRBV != "")
total_counts <- filtered_data %>%
group_by(cluster) %>%
summarise(total_cells = n())
selected_data <- filtered_data %>%
mutate(tcr_group = case_when(
TRAV == "TRAV13-1" & TRBV == "TRBV20-1" ~ "TRAV13-1 + TRBV20-1",
TRAV == "TRAV13-1" ~ "TRAV13-1",
TRBV == "TRBV20-1" ~ "TRBV20-1",
TRUE ~ NA_character_
)) %>%
filter(!is.na(tcr_group))
group_counts <- selected_data %>%
group_by(cluster, tcr_group) %>%
summarise(count = n(), .groups = "drop")
bar_data <- group_counts %>%
left_join(total_counts, by = "cluster") %>%
mutate(freq = count / total_cells * 100)
# تنظیم ترتیب لجند
bar_data$tcr_group <- factor(bar_data$tcr_group, levels = c("TRAV13-1 + TRBV20-1", "TRAV13-1", "TRBV20-1"))
tcr_colors <- c(
"TRAV13-1 + TRBV20-1" = "#cfe3f6",  # آبی خیلی تیره
"TRAV13-1"             = "#5eaada",  # بنفش تیره
"TRBV20-1"             = "#1367b7"   # سرمه‌ای خیلی تیره (مشکی مایل به آبی)
)
bar_plot <- ggplot(bar_data, aes(x = cluster, y = freq, fill = tcr_group)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_manual(values = tcr_colors, name = "TCR Group") +
scale_y_continuous(labels = label_percent(scale = 1)) +
labs(x = "Cluster", y = "Percentage of Cells",
title = "Proportion of Specific TCR Gene Combinations Across CD4 Clusters") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(
"TCR_barplot_by_cluster_selected_groups.png",
plot = bar_plot,
width = 8,
height = 6,
dpi = 300,
bg = "white"
)
load("C:/Esmaeil/CeliacProject/BackUp/Meta Data/MetaData_Esmaeil.Rdata")
library(dplyr)
library(tidyr)
library(readr)
cluster_order <- c("Th1 Mem", "Th17", "Th2/Tfh", "Tregs")
full_metadata$cluster <- factor(full_metadata$cluster, levels = cluster_order)
full_metadata <- full_metadata %>%
filter(!is.na(cluster) & !is.na(TRAV) & TRAV != "" & !is.na(TRBV) & TRBV != "") %>%
distinct(cdr_Full_ab, .keep_all = TRUE)
# ----------TRAV + TRBV----------
combo_counts <- full_metadata %>% count(TRAV, TRBV, name = "repeat_time")
cluster_counts <- full_metadata %>%
count(TRAV, TRBV, cluster) %>%
pivot_wider(names_from = cluster, values_from = n, values_fill = 0)
final_counts <- combo_counts %>%
left_join(cluster_counts, by = c("TRAV", "TRBV")) %>%
arrange(desc(repeat_time))
# -----------TRAV-----------
trav_total <- full_metadata %>%
count(TRAV, name = "total")
trav_by_cluster <- full_metadata %>%
count(TRAV, cluster) %>%
pivot_wider(names_from = cluster, values_from = n, values_fill = 0)
trav_table <- trav_total %>%
left_join(trav_by_cluster, by = "TRAV") %>%
arrange(desc(total))
# -----------TRBV-----------
trbv_total <- full_metadata %>%
count(TRBV, name = "total")
trbv_by_cluster <- full_metadata %>%
count(TRBV, cluster) %>%
pivot_wider(names_from = cluster, values_from = n, values_fill = 0)
trbv_table <- trbv_total %>%
left_join(trbv_by_cluster, by = "TRBV") %>%
arrange(desc(total))
View(trbv_table)
