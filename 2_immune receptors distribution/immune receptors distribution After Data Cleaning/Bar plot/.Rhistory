cex.names = 0.2,    # Font size of x labels
cex.axis = 0.2,     # Font size of axis numbers
cex.lab = 0.2,      # Font size of axis titles
cex.main = 0.2,     # Font size of main title
ylim = c(0, ylim_max)
)
# Rotate x labels by 45 degrees
text(
x = bar_positions,
y = -0.05 * ylim_max, # place below x-axis
labels = rownames(count_df),
srt = 45,
adj = 1,
xpd = TRUE,
cex = 0.7
)
dev.off()
}
setwd("C:/Esmaeil/CeliacProject/CeliacProject/2_immune receptors distribution/immune receptors distribution After Data Cleaning (Bar plot)")
library(ggplot2)
library(dplyr)
library(cowplot)
# Define receptor colors and labels
receptor_colors <- c(
"αβ" = "#ee1819",
"γδ" = "#fd7d00",
"hkl" = "#fcd919",
"Aberrant αβ" = "#3a78ce",
"Aberrant γ" = "#47ad45",
"None" = "#eeeeee"
)
#-------------------------------------------------------------------------------- Bar Plot of Immune Receptor Distribution Across Clusters
valid_receptors <- c("αβ", "γδ", "hkl", "Aberrant αβ", "Aberrant γ")
full_metadata <- full_metadata %>%
filter(
!is.na(imm_receptor_Esmaeil),
imm_receptor_Esmaeil %in% valid_receptors,
!is.na(cluster),
cluster != ""
)
table_data <- table(full_metadata$cluster, full_metadata$imm_receptor_Esmaeil)
count_df <- as.data.frame.matrix(table_data)
count_df <- count_df[, colnames(count_df) %in% valid_receptors]
barplot_labels <- c(
"αβ" = "TCRαβ",
"γδ" = "TCRγδ",
"hkl" = "hkl",
"Aberrant αβ" = "Aberrant αβ",
"Aberrant γ" = "Aberrant γ"
)
for (receptor in colnames(count_df)) {
png_filename <- paste0("BarPlot_", gsub(" ", "_", receptor), ".png")
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
# Open PNG device
png(filename = png_filename, width = 4000, height = 2000, res = 600)
# Create barplot with custom fonts and label rotation
bar_positions <- barplot(
count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", barplot_labels[[receptor]], "Receptor Across Clusters"),
xlab = "Clusters",
ylab = "Count",
col = receptor_colors[[receptor]],
las = 2,
cex.names = 0.2,    # Font size of x labels
cex.axis = 0.2,     # Font size of axis numbers
cex.lab = 0.2,      # Font size of axis titles
cex.main = 0.2,     # Font size of main title
ylim = c(0, ylim_max)
)
# Rotate x labels by 45 degrees
text(
x = bar_positions,
y = -0.05 * ylim_max, # place below x-axis
labels = rownames(count_df),
srt = 45,
adj = 1,
xpd = TRUE,
cex = 0.7
)
dev.off()
}
setwd("C:/Esmaeil/CeliacProject/CeliacProject/2_immune receptors distribution/immune receptors distribution After Data Cleaning (Bar plot)")
library(ggplot2)
library(dplyr)
library(cowplot)
# Define receptor colors and labels
receptor_colors <- c(
"αβ" = "#ee1819",
"γδ" = "#fd7d00",
"hkl" = "#fcd919",
"Aberrant αβ" = "#3a78ce",
"Aberrant γ" = "#47ad45",
"None" = "#eeeeee"
)
#-------------------------------------------------------------------------------- Bar Plot of Immune Receptor Distribution Across Clusters
valid_receptors <- c("αβ", "γδ", "hkl", "Aberrant αβ", "Aberrant γ")
full_metadata <- full_metadata %>%
filter(
!is.na(imm_receptor_Esmaeil),
imm_receptor_Esmaeil %in% valid_receptors,
!is.na(cluster),
cluster != ""
)
table_data <- table(full_metadata$cluster, full_metadata$imm_receptor_Esmaeil)
count_df <- as.data.frame.matrix(table_data)
count_df <- count_df[, colnames(count_df) %in% valid_receptors]
barplot_labels <- c(
"αβ" = "TCRαβ",
"γδ" = "TCRγδ",
"hkl" = "hkl",
"Aberrant αβ" = "Aberrant αβ",
"Aberrant γ" = "Aberrant γ"
)
for (receptor in colnames(count_df)) {
png_filename <- paste0("BarPlot_", gsub(" ", "_", receptor), ".png")
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", barplot_labels[[receptor]], "receptor across clusters"),
xlab = "Clusters",
ylab = "Count",
col = receptor_colors[[receptor]],
las = 2,
cex.names = 0.6,    # Font size of x labels
cex.axis = 0.8,     # Font size of axis numbers
cex.lab = 1.2,      # Font size of axis titles
cex.main = 1.4,     # Font size of main title
ylim = c(0, ylim_max))
dev.off()
}
setwd("C:/Esmaeil/CeliacProject/CeliacProject/2_immune receptors distribution/immune receptors distribution After Data Cleaning (Bar plot)")
library(ggplot2)
library(dplyr)
library(cowplot)
# Define receptor colors and labels
receptor_colors <- c(
"αβ" = "#ee1819",
"γδ" = "#fd7d00",
"hkl" = "#fcd919",
"Aberrant αβ" = "#3a78ce",
"Aberrant γ" = "#47ad45",
"None" = "#eeeeee"
)
#-------------------------------------------------------------------------------- Bar Plot of Immune Receptor Distribution Across Clusters
valid_receptors <- c("αβ", "γδ", "hkl", "Aberrant αβ", "Aberrant γ")
full_metadata <- full_metadata %>%
filter(
!is.na(imm_receptor_Esmaeil),
imm_receptor_Esmaeil %in% valid_receptors,
!is.na(cluster),
cluster != ""
)
table_data <- table(full_metadata$cluster, full_metadata$imm_receptor_Esmaeil)
count_df <- as.data.frame.matrix(table_data)
count_df <- count_df[, colnames(count_df) %in% valid_receptors]
barplot_labels <- c(
"αβ" = "TCRαβ",
"γδ" = "TCRγδ",
"hkl" = "hkl",
"Aberrant αβ" = "Aberrant αβ",
"Aberrant γ" = "Aberrant γ"
)
for (receptor in colnames(count_df)) {
png_filename <- paste0("BarPlot_", gsub(" ", "_", receptor), ".png")
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", barplot_labels[[receptor]], "receptor across clusters"),
xlab = "Clusters",
ylab = "Count",
col = receptor_colors[[receptor]],
las = 2,
cex.names = 0.4,    # Font size of x labels
cex.axis = 0.8,     # Font size of axis numbers
cex.lab = 1.2,      # Font size of axis titles
cex.main = 1.4,     # Font size of main title
ylim = c(0, ylim_max))
dev.off()
}
setwd("C:/Esmaeil/CeliacProject/CeliacProject/2_immune receptors distribution/immune receptors distribution After Data Cleaning (Bar plot)")
library(ggplot2)
library(dplyr)
library(cowplot)
# Define receptor colors and labels
receptor_colors <- c(
"αβ" = "#ee1819",
"γδ" = "#fd7d00",
"hkl" = "#fcd919",
"Aberrant αβ" = "#3a78ce",
"Aberrant γ" = "#47ad45",
"None" = "#eeeeee"
)
#-------------------------------------------------------------------------------- Bar Plot of Immune Receptor Distribution Across Clusters
valid_receptors <- c("αβ", "γδ", "hkl", "Aberrant αβ", "Aberrant γ")
full_metadata <- full_metadata %>%
filter(
!is.na(imm_receptor_Esmaeil),
imm_receptor_Esmaeil %in% valid_receptors,
!is.na(cluster),
cluster != ""
)
table_data <- table(full_metadata$cluster, full_metadata$imm_receptor_Esmaeil)
count_df <- as.data.frame.matrix(table_data)
count_df <- count_df[, colnames(count_df) %in% valid_receptors]
barplot_labels <- c(
"αβ" = "TCRαβ",
"γδ" = "TCRγδ",
"hkl" = "hkl",
"Aberrant αβ" = "Aberrant αβ",
"Aberrant γ" = "Aberrant γ"
)
for (receptor in colnames(count_df)) {
png_filename <- paste0("BarPlot_", gsub(" ", "_", receptor), ".png")
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", barplot_labels[[receptor]], "receptor across clusters"),
xlab = "Clusters",
ylab = "Count",
col = receptor_colors[[receptor]],
las = 2,
cex.names = 0.4,    # Font size of x labels
cex.axis = 0.8,     # Font size of axis numbers
cex.lab = 1.2,      # Font size of axis titles
cex.main = 1,     # Font size of main title
ylim = c(0, ylim_max))
dev.off()
}
setwd("C:/Esmaeil/CeliacProject/CeliacProject/2_immune receptors distribution/immune receptors distribution After Data Cleaning (Bar plot)")
library(ggplot2)
library(dplyr)
library(cowplot)
# Define receptor colors and labels
receptor_colors <- c(
"αβ" = "#ee1819",
"γδ" = "#fd7d00",
"hkl" = "#fcd919",
"Aberrant αβ" = "#3a78ce",
"Aberrant γ" = "#47ad45",
"None" = "#eeeeee"
)
#-------------------------------------------------------------------------------- Bar Plot of Immune Receptor Distribution Across Clusters
valid_receptors <- c("αβ", "γδ", "hkl", "Aberrant αβ", "Aberrant γ")
full_metadata <- full_metadata %>%
filter(
!is.na(imm_receptor_Esmaeil),
imm_receptor_Esmaeil %in% valid_receptors,
!is.na(cluster),
cluster != ""
)
table_data <- table(full_metadata$cluster, full_metadata$imm_receptor_Esmaeil)
count_df <- as.data.frame.matrix(table_data)
count_df <- count_df[, colnames(count_df) %in% valid_receptors]
barplot_labels <- c(
"αβ" = "TCRαβ",
"γδ" = "TCRγδ",
"hkl" = "hkl",
"Aberrant αβ" = "Aberrant αβ",
"Aberrant γ" = "Aberrant γ"
)
for (receptor in colnames(count_df)) {
png_filename <- paste0("BarPlot_", gsub(" ", "_", receptor), ".png")
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", barplot_labels[[receptor]], "receptor across clusters"),
xlab = "Clusters",
ylab = "Count",
col = receptor_colors[[receptor]],
las = 2,
cex.main = 1,     # Font size of main title
cex.names = 0.4,    # Font size of x labels
cex.axis = 0.4,     # Font size of axis numbers
cex.lab = 1.2,      # Font size of axis titles
ylim = c(0, ylim_max))
dev.off()
}
setwd("C:/Esmaeil/CeliacProject/CeliacProject/2_immune receptors distribution/immune receptors distribution After Data Cleaning (Bar plot)")
library(ggplot2)
library(dplyr)
library(cowplot)
# Define receptor colors and labels
receptor_colors <- c(
"αβ" = "#ee1819",
"γδ" = "#fd7d00",
"hkl" = "#fcd919",
"Aberrant αβ" = "#3a78ce",
"Aberrant γ" = "#47ad45",
"None" = "#eeeeee"
)
#-------------------------------------------------------------------------------- Bar Plot of Immune Receptor Distribution Across Clusters
valid_receptors <- c("αβ", "γδ", "hkl", "Aberrant αβ", "Aberrant γ")
full_metadata <- full_metadata %>%
filter(
!is.na(imm_receptor_Esmaeil),
imm_receptor_Esmaeil %in% valid_receptors,
!is.na(cluster),
cluster != ""
)
table_data <- table(full_metadata$cluster, full_metadata$imm_receptor_Esmaeil)
count_df <- as.data.frame.matrix(table_data)
count_df <- count_df[, colnames(count_df) %in% valid_receptors]
barplot_labels <- c(
"αβ" = "TCRαβ",
"γδ" = "TCRγδ",
"hkl" = "hkl",
"Aberrant αβ" = "Aberrant αβ",
"Aberrant γ" = "Aberrant γ"
)
for (receptor in colnames(count_df)) {
png_filename <- paste0("BarPlot_", gsub(" ", "_", receptor), ".png")
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
barplot(count_df[[receptor]],
names.arg = rownames(count_df),
main = paste("Distribution of", barplot_labels[[receptor]], "receptor across clusters"),
xlab = "Clusters",
ylab = "Count",
col = receptor_colors[[receptor]],
las = 2,
cex.main = 1,     # Font size of main title
cex.names = 0.4,    # Font size of x labels
cex.axis = 0.4,     # Font size of axis numbers
cex.lab = 0.5,      # Font size of axis titles
ylim = c(0, ylim_max))
dev.off()
}
setwd("C:/Esmaeil/CeliacProject/CeliacProject/2_immune receptors distribution/immune receptors distribution After Data Cleaning (Bar plot)")
library(ggplot2)
library(dplyr)
library(cowplot)
# Define receptor colors and labels
receptor_colors <- c(
"αβ" = "#ee1819",
"γδ" = "#fd7d00",
"hkl" = "#fcd919",
"Aberrant αβ" = "#3a78ce",
"Aberrant γ" = "#47ad45",
"None" = "#eeeeee"
)
#-------------------------------------------------------------------------------- Bar Plot of Immune Receptor Distribution Across Clusters
valid_receptors <- c("αβ", "γδ", "hkl", "Aberrant αβ", "Aberrant γ")
full_metadata <- full_metadata %>%
filter(
!is.na(imm_receptor_Esmaeil),
imm_receptor_Esmaeil %in% valid_receptors,
!is.na(cluster),
cluster != ""
)
table_data <- table(full_metadata$cluster, full_metadata$imm_receptor_Esmaeil)
count_df <- as.data.frame.matrix(table_data)
count_df <- count_df[, colnames(count_df) %in% valid_receptors]
barplot_labels <- c(
"αβ" = "TCRαβ",
"γδ" = "TCRγδ",
"hkl" = "hkl",
"Aberrant αβ" = "Aberrant αβ",
"Aberrant γ" = "Aberrant γ"
)
for (receptor in colnames(count_df)) {
png_filename <- paste0("BarPlot_", gsub(" ", "_", receptor), ".png")
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
# Draw barplot without axis names
bp <- barplot(count_df[[receptor]],
names.arg = FALSE,
main = paste("Distribution of", barplot_labels[[receptor]], "receptor across clusters"),
xlab = "Clusters",
ylab = "Count",
col = receptor_colors[[receptor]],
cex.main = 1,
cex.axis = 0.4,
cex.lab = 0.5,
ylim = c(0, ylim_max))
# Add 45-degree rotated x labels
text(x = bp,
y = par("usr")[3] - 0.02 * ylim_max,
labels = rownames(count_df),
srt = 45,        # rotation angle
adj = 1,         # right alignment
xpd = TRUE,      # allow drawing outside plot area
cex = 0.4)
dev.off()
}
setwd("C:/Esmaeil/CeliacProject/CeliacProject/2_immune receptors distribution/immune receptors distribution After Data Cleaning (Bar plot)")
library(ggplot2)
library(dplyr)
library(cowplot)
# Define receptor colors and labels
receptor_colors <- c(
"αβ" = "#ee1819",
"γδ" = "#fd7d00",
"hkl" = "#fcd919",
"Aberrant αβ" = "#3a78ce",
"Aberrant γ" = "#47ad45",
"None" = "#eeeeee"
)
#-------------------------------------------------------------------------------- Bar Plot of Immune Receptor Distribution Across Clusters
valid_receptors <- c("αβ", "γδ", "hkl", "Aberrant αβ", "Aberrant γ")
full_metadata <- full_metadata %>%
filter(
!is.na(imm_receptor_Esmaeil),
imm_receptor_Esmaeil %in% valid_receptors,
!is.na(cluster),
cluster != ""
)
table_data <- table(full_metadata$cluster, full_metadata$imm_receptor_Esmaeil)
count_df <- as.data.frame.matrix(table_data)
count_df <- count_df[, colnames(count_df) %in% valid_receptors]
barplot_labels <- c(
"αβ" = "TCRαβ",
"γδ" = "TCRγδ",
"hkl" = "hkl",
"Aberrant αβ" = "Aberrant αβ",
"Aberrant γ" = "Aberrant γ"
)
for (receptor in colnames(count_df)) {
png_filename <- paste0("BarPlot_", gsub(" ", "_", receptor), ".png")
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
# Draw barplot without axis names
bp <- barplot(count_df[[receptor]],
names.arg = FALSE,
main = paste("Distribution of", barplot_labels[[receptor]], "receptor across clusters"),
xlab = "Clusters",
ylab = "Count",
col = receptor_colors[[receptor]],
cex.main = 1,
cex.axis = 0.4,
cex.lab = 0.5,
ylim = c(0, ylim_max))
# Add 45-degree rotated x labels
text(x = bp,
y = par("usr")[3] - 0.07 * ylim_max,
labels = rownames(count_df),
srt = 45,        # rotation angle
adj = 1,         # right alignment
xpd = TRUE,      # allow drawing outside plot area
cex = 0.4)
dev.off()
}
setwd("C:/Esmaeil/CeliacProject/CeliacProject/2_immune receptors distribution/immune receptors distribution After Data Cleaning (Bar plot)")
library(ggplot2)
library(dplyr)
library(cowplot)
# Define receptor colors and labels
receptor_colors <- c(
"αβ" = "#ee1819",
"γδ" = "#fd7d00",
"hkl" = "#fcd919",
"Aberrant αβ" = "#3a78ce",
"Aberrant γ" = "#47ad45",
"None" = "#eeeeee"
)
#-------------------------------------------------------------------------------- Bar Plot of Immune Receptor Distribution Across Clusters
valid_receptors <- c("αβ", "γδ", "hkl", "Aberrant αβ", "Aberrant γ")
full_metadata <- full_metadata %>%
filter(
!is.na(imm_receptor_Esmaeil),
imm_receptor_Esmaeil %in% valid_receptors,
!is.na(cluster),
cluster != ""
)
table_data <- table(full_metadata$cluster, full_metadata$imm_receptor_Esmaeil)
count_df <- as.data.frame.matrix(table_data)
count_df <- count_df[, colnames(count_df) %in% valid_receptors]
barplot_labels <- c(
"αβ" = "TCRαβ",
"γδ" = "TCRγδ",
"hkl" = "hkl",
"Aberrant αβ" = "Aberrant αβ",
"Aberrant γ" = "Aberrant γ"
)
for (receptor in colnames(count_df)) {
png_filename <- paste0("BarPlot_", gsub(" ", "_", receptor), ".png")
max_y <- max(count_df[[receptor]])
ylim_max <- max_y * 1.1
png(filename = png_filename, width = 4000, height = 2000, res = 600)
# Draw barplot without axis names
bp <- barplot(count_df[[receptor]],
names.arg = FALSE,
main = paste("Distribution of", barplot_labels[[receptor]], "receptor across clusters"),
xlab = "Clusters",
ylab = "Count",
col = receptor_colors[[receptor]],
cex.main = 1,
cex.axis = 0.4,
cex.lab = 0.5,
ylim = c(0, ylim_max))
# Add 45-degree rotated x labels
text(x = bp,
y = par("usr")[3] - 0.05 * ylim_max,
labels = rownames(count_df),
srt = 45,        # rotation angle
adj = 1,         # right alignment
xpd = TRUE,      # allow drawing outside plot area
cex = 0.4)
dev.off()
}
