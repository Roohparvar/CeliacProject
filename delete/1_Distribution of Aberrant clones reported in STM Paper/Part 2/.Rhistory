setwd("C:/Esmaeil/CeliacProject/CeliacProject/4_Distribution of Aberrant T Cells")
# ------------------------------------------------------ Part 2: Aberrant ab vs g ---------------------------
library(ggplot2)
library(dplyr)
color_map <- c(
"Aberrant ab" = "#3A78CE",
"Aberrant g"  = "#47AD45",
"Other"       = "grey80"
)
plot_df <- full_metadata %>%
mutate(
receptor_label = case_when(
imm_receptor_Esmaeil == "Aberrant ab" ~ "Aberrant ab",
imm_receptor_Esmaeil == "Aberrant g"  ~ "Aberrant g",
TRUE                                  ~ "Other"
),
receptor_label = factor(receptor_label, levels = c("Other", "Aberrant ab", "Aberrant g"))
)
load("C:/Esmaeil/CeliacProject/BackUp/Meta Data/MetaData_Esmaeil.Rdata")
# ------------------------------------------------------ Part 2: Aberrant ab vs g ---------------------------
library(ggplot2)
library(dplyr)
color_map <- c(
"Aberrant ab" = "#3A78CE",
"Aberrant g"  = "#47AD45",
"Other"       = "grey80"
)
plot_df <- full_metadata %>%
mutate(
receptor_label = case_when(
imm_receptor_Esmaeil == "Aberrant ab" ~ "Aberrant ab",
imm_receptor_Esmaeil == "Aberrant g"  ~ "Aberrant g",
TRUE                                  ~ "Other"
),
receptor_label = factor(receptor_label, levels = c("Other", "Aberrant ab", "Aberrant g"))
)
umap_plot <- ggplot(plot_df, aes(x = scVI_with_hvg_UMAP_1, y = scVI_with_hvg_UMAP_2)) +
geom_point(data = filter(plot_df, receptor_label == "Other"),
color = "grey80", size = 0.5, alpha = 0.4) +
geom_point(data = filter(plot_df, receptor_label != "Other"),
aes(color = receptor_label), size = 0.2, alpha = 0.8) +
scale_color_manual(
values = color_map,
name = "Immune Receptor",
labels = c("Other" = "Other", "Aberrant ab" = "Aberrant ⍺β", "Aberrant g" = "Aberrant γ")
) +
guides(color = guide_legend(override.aes = list(size = 3))) +
labs(
title = "UMAP Plot Colored by Aberrant Immune Receptors",
x = "UMAP 1", y = "UMAP 2"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 12),
legend.position = "right",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white", color = NA)
)
ggsave("2_UMAP_Aberrant_Receptors.png", umap_plot, width = 10, height = 6, dpi = 300, bg = "white")
load("C:/Esmaeil/CeliacProject/BackUp/Meta Data/MetaData_Esmaeil.Rdata")
full_metadata1 <- subset(full_metadata, imm_receptor_Esmaeil == "Aberrant ab" | imm_receptor_Esmaeil == "Aberrant g")
full_metadata2 <- subset(full_metadata,
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV25" & TRAJ == "TRAJ36" & TRBV == "TRBV27" & TRBJ == "TRBJ1-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV29/DV5" & TRAJ == "TRAJ17" & TRBV == "TRBV27" & TRBJ == "TRBJ1-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV1-1" & TRAJ == "TRAJ4" & TRBV == "TRBV29-1" & TRBJ == "TRBJ1-2") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV29/DV5" & TRAJ == "TRAJ49" & TRBV == "TRBV7-9" & TRBJ == "TRBJ2-1") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV8-1" & TRAJ == "TRAJ27" & TRBV == "TRBV19" & TRBJ == "TRBJ2-7") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV8-1" & TRAJ == "TRAJ22" & TRBV == "TRBV19" & TRBJ == "TRBJ2-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV10" & TRAJ == "TRAJ39" & TRBV == "TRBV6-5" & TRBJ == "TRBJ1-4") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV26-1" & TRAJ == "TRAJ17" & TRBV == "TRBV6-5" & TRBJ == "TRBJ1-4") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV3" & TRGJ == "TRGJ1") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV8" & TRGJ == "TRGJP2") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV3" & TRGJ == "TRGJP2") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV10" & TRGJ == "TRGJ1")
)
View(full_metadata)
View(full_metadata1)
View(full_metadata2)
library(dplyr)
diff_rows <- anti_join(meta1, meta2)
library(dplyr)
diff_rows <- anti_join(full_metadata1, full_metadata2)
View(diff_rows)
table(diff_rows$TRAV)
aberrant_ab_clones <- diff_rows %>%
filter(imm_receptor_Esmaeil == "Aberrant ab") %>%
distinct(TRAV, TRAJ, TRBV, TRBJ)
# For Aberrant g
aberrant_g_clones <- diff_rows %>%
filter(imm_receptor_Esmaeil == "Aberrant g") %>%
distinct(TRGV, TRGJ)
View(aberrant_ab_clones)
View(aberrant_g_clones)
View(full_metadata1)
View(diff_rows)
dif675 <- subset(full_metadata, cdr_Full_ab == "CAASAIQAAGNKLTF+CASSYVRGTRPQHF")
View(dif675)
dif93 <- subset(full_metadata, cdr_Full_ab == "CAVISGGYNKLIF+CSVEWGDREGYTF")
View(dif93)
View(diff_rows)
View(diff_rows)
View(dif93)
View(diff_rows)
setwd("C:/Esmaeil/CeliacProject/CeliacProject/3_Distribution of Aberrant clones reported in STM Paper/Part 2")
install.packages("writexl")
library(writexl)
write_xlsx(diff_rows, "diff_rows.xlsx")
View(dif675)
table(dif675$TRAV)
View(dif93)
table(dif93$TRAV)
View(diff_rows)
View(diff_rows)
table(diff_rows$TRAV, diff_rows$TRAJ)
table(diff_rows$TRAV)
aberrant_ab_clones <- diff_rows %>%
filter(imm_receptor_Esmaeil == "Aberrant ab") %>%
distinct(TRAV, TRAJ, TRBV, TRBJ)
# For Aberrant g
aberrant_g_clones <- diff_rows %>%
filter(imm_receptor_Esmaeil == "Aberrant g") %>%
distinct(TRGV, TRGJ)
View(aberrant_ab_clones)
load("C:/Esmaeil/CeliacProject/BackUp/Meta Data/MetaData_Esmaeil.Rdata")
install.packages("writexl")
library(dplyr)
library(writexl)
full_metadata_This_Paper <- subset(full_metadata, imm_receptor_Esmaeil == "Aberrant ab" | imm_receptor_Esmaeil == "Aberrant g")
full_metadata2_STM_Paper <- subset(full_metadata,
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV25" & TRAJ == "TRAJ36" & TRBV == "TRBV27" & TRBJ == "TRBJ1-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV29/DV5" & TRAJ == "TRAJ17" & TRBV == "TRBV27" & TRBJ == "TRBJ1-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV1-1" & TRAJ == "TRAJ4" & TRBV == "TRBV29-1" & TRBJ == "TRBJ1-2") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV29/DV5" & TRAJ == "TRAJ49" & TRBV == "TRBV7-9" & TRBJ == "TRBJ2-1") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV8-1" & TRAJ == "TRAJ27" & TRBV == "TRBV19" & TRBJ == "TRBJ2-7") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV8-1" & TRAJ == "TRAJ22" & TRBV == "TRBV19" & TRBJ == "TRBJ2-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV10" & TRAJ == "TRAJ39" & TRBV == "TRBV6-5" & TRBJ == "TRBJ1-4") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV26-1" & TRAJ == "TRAJ17" & TRBV == "TRBV6-5" & TRBJ == "TRBJ1-4") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV3" & TRGJ == "TRGJ1") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV8" & TRGJ == "TRGJP2") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV3" & TRGJ == "TRGJP2") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV10" & TRGJ == "TRGJ1")
)
diff_rows <- anti_join(full_metadata_This_Paper, full_metadata2_STM_Paper)
write_xlsx(diff_rows, "diff_rows.xlsx")
install.packages("writexl")
library(dplyr)
library(writexl)
full_metadata_This_Paper <- subset(full_metadata, imm_receptor_Esmaeil == "Aberrant ab" | imm_receptor_Esmaeil == "Aberrant g")
full_metadata2_STM_Paper <- subset(full_metadata,
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV25" & TRAJ == "TRAJ36" & TRBV == "TRBV27" & TRBJ == "TRBJ1-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV29/DV5" & TRAJ == "TRAJ17" & TRBV == "TRBV27" & TRBJ == "TRBJ1-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV1-1" & TRAJ == "TRAJ4" & TRBV == "TRBV29-1" & TRBJ == "TRBJ1-2") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV29/DV5" & TRAJ == "TRAJ49" & TRBV == "TRBV7-9" & TRBJ == "TRBJ2-1") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV8-1" & TRAJ == "TRAJ27" & TRBV == "TRBV19" & TRBJ == "TRBJ2-7") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV8-1" & TRAJ == "TRAJ22" & TRBV == "TRBV19" & TRBJ == "TRBJ2-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV10" & TRAJ == "TRAJ39" & TRBV == "TRBV6-5" & TRBJ == "TRBJ1-4") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV26-1" & TRAJ == "TRAJ17" & TRBV == "TRBV6-5" & TRBJ == "TRBJ1-4") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV3" & TRGJ == "TRGJ1") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV8" & TRGJ == "TRGJP2") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV3" & TRGJ == "TRGJP2") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV10" & TRGJ == "TRGJ1")
)
diff_rows <- anti_join(full_metadata_This_Paper, full_metadata2_STM_Paper)
write_xlsx(diff_rows, "diff_rows.xlsx")
aberrant_ab_clones <- diff_rows %>%
filter(imm_receptor_Esmaeil == "Aberrant ab") %>%
distinct(TRAV, TRAJ, TRBV, TRBJ)
# For Aberrant g
aberrant_g_clones <- diff_rows %>%
filter(imm_receptor_Esmaeil == "Aberrant g") %>%
distinct(TRGV, TRGJ)
View(aberrant_g_clones)
View(aberrant_ab_clones)
View(diff_rows)
View(full_metadata)
load("C:/Esmaeil/CeliacProject/BackUp/Meta Data/MetaData_jerome.Rdata")
unique(full_metadata$imm_receptor)
full = full_metadata[full_metadata, full_metadata$imm_receptor== "Aberrant g"]
full = full_metadata[full_metadata, imm_receptor== "Aberrant g"]
full = full_metadata[full_metadata, full_metadata$imm_receptor== "Aberrant g", ]
full = full_metadata[full_metadata$imm_receptor== "Aberrant g", ]
View(full)
full <- full[, c("imm_receptor", setdiff(names(full), "imm_receptor"))]
full <- full[, c("clone_size_ab", setdiff(names(full), "clone_size_ab"))]
full <- full[, c("clone_size_gd", setdiff(names(full), "clone_size_gd"))]
table(full$clone_size_gd)
table(full_metadata$clone_size_gd)
table(full_metadata$g_cdr3)
load("C:/Esmaeil/CeliacProject/BackUp/Meta Data/MetaData_Esmaeil.Rdata")
install.packages("writexl")
library(dplyr)
library(writexl)
full_metadata_This_Paper <- subset(full_metadata, imm_receptor_Esmaeil == "Aberrant ab" | imm_receptor_Esmaeil == "Aberrant g")
full_metadata2_STM_Paper <- subset(full_metadata,
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV25" & TRAJ == "TRAJ36" & TRBV == "TRBV27" & TRBJ == "TRBJ1-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV29/DV5" & TRAJ == "TRAJ17" & TRBV == "TRBV27" & TRBJ == "TRBJ1-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV1-1" & TRAJ == "TRAJ4" & TRBV == "TRBV29-1" & TRBJ == "TRBJ1-2") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV29/DV5" & TRAJ == "TRAJ49" & TRBV == "TRBV7-9" & TRBJ == "TRBJ2-1") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV8-1" & TRAJ == "TRAJ27" & TRBV == "TRBV19" & TRBJ == "TRBJ2-7") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV8-1" & TRAJ == "TRAJ22" & TRBV == "TRBV19" & TRBJ == "TRBJ2-5") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV10" & TRAJ == "TRAJ39" & TRBV == "TRBV6-5" & TRBJ == "TRBJ1-4") |
(imm_receptor_Esmaeil == "Aberrant ab" & TRAV == "TRAV26-1" & TRAJ == "TRAJ17" & TRBV == "TRBV6-5" & TRBJ == "TRBJ1-4") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV3" & TRGJ == "TRGJ1") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV8" & TRGJ == "TRGJP2") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV3" & TRGJ == "TRGJP2") |
(imm_receptor_Esmaeil == "Aberrant g" & TRGV == "TRGV10" & TRGJ == "TRGJ1")
)
diff_rows <- anti_join(full_metadata_This_Paper, full_metadata2_STM_Paper)
write_xlsx(diff_rows, "diff_rows.xlsx")
aberrant_ab_clones <- diff_rows %>%
filter(imm_receptor_Esmaeil == "Aberrant ab") %>%
distinct(TRAV, TRAJ, TRBV, TRBJ)
# For Aberrant g
aberrant_g_clones <- diff_rows %>%
filter(imm_receptor_Esmaeil == "Aberrant g") %>%
distinct(TRGV, TRGJ)
View(diff_rows)
fullab = full_metadata[full_metadata$imm_receptor== "Aberrant ab", ]
fullab = full_metadata[full_metadata$imm_receptor== "Aberrant ab", ]
load("C:/Esmaeil/CeliacProject/BackUp/Meta Data/MetaData_Esmaeil.Rdata")
fullab = full_metadata[full_metadata$imm_receptor== "Aberrant ab", ]
fullab = full_metadata[full_metadata$imm_receptor== "Aberant ab", ]
fullab = full_metadata[full_metadata$imm_receptor_Esmaeil== "Aberrant ab", ]
View(fullab)
View(full_metadata)
unique(full_metadata$imm_receptor_Esmaeil)
fullab = full_metadata[full_metadata$imm_receptor_Esmaeil== "Aberrant ab", ]
View(fullab)
aberrant_ab_cells <- full_metadata[full_metadata$imm_receptor_Esmaeil == "Aberrant ab", ]
View(aberrant_ab_cells)
library(dplyr)
aberrant_ab_cells <- full_metadata %>%
filter(imm_receptor_Esmaeil == "Aberrant ab")
View(aberrant_ab_cells)
table(aberrant_ab_cells$clone_size_ab)
table(aberrant_ab_cells$clone_size_gd)
table(aberrant_ab_cells$imm_receptor_Esmaeil)
library(dplyr)
aberrant_ab_cellsTen <- aberrant_ab_cells %>%
filter(clone_size_ab == "10")
View(aberrant_ab_cellsTen)
View(full_metadata)
View(aberrant_ab_cells)
