library(Seurat)
library(SeuratObject)
count_matrix <- matrix(
data = c(0, 1, 3, 0, 2, 0, 0, 5, 1, 1, 0, 0),
nrow = 3,
ncol = 4,
dimnames = list(c("GeneA", "GeneB", "GeneC"), c("Cell1", "Cell2", "Cell3", "Cell4"))
)
seurat_obj2 <- CreateSeuratObject(counts = count_matrix, project = "SimpleExample", min.cells = 0, min.features = 0)
View(seurat_obj2)
count_matrix <- matrix(
data = c(0, 1, 3, 0, 2, 0, 0, 5, 1, 1, 0, 0),
nrow = 3,
ncol = 4,
dimnames = list(c("GeneA", "GeneB", "GeneC"), c("Cell1", "Cell2", "Cell3", "Cell4"))
)
seurat_obj2 <- CreateSeuratObject(counts = count_matrix, project = "SimpleExample", min.cells = 0, min.features = 0, assay = "ADT")
count_matrix <- matrix(
data = c(0, 1, 3, 0, 2, 0, 0, 5, 1, 1, 0, 0),
nrow = 3,
ncol = 4,
dimnames = list(c("GeneA", "GeneB", "GeneC"), c("Cell1", "Cell2", "Cell3", "Cell4"))
)
seurat_obj2 <- CreateSeuratObject(counts = count_matrix, project = "SimpleExample", min.cells = 0, min.features = 0)
seurat_obj2@meta.data
View(count_matrix)
count_matrix <- matrix(
data = c(0, 1, 3, 0, 2, 0, 0, 5, 1, 1, 0, 0),
nrow = 3,
ncol = 4,
dimnames = list(c("GeneA", "GeneB", "GeneC"), c("Cell1", "Cell2", "Cell3", "Cell4"))
)
seurat_obj2 <- CreateSeuratObject(counts = count_matrix, min.cells = 0, min.features = 0)
View(count_matrix)
seurat_obj2@meta.data
seurat_obj2@assays[["RNA"]]@misc[["calcN"]]
View(seurat_obj2)
library(Seurat)
library(SeuratObject)
count_matrix <- matrix(
data = c(0, 1, 3, 0, 2, 0, 0, 5, 1, 1, 0, 0),
nrow = 3,
ncol = 4,
dimnames = list(c("GeneA", "GeneB", "GeneC"), c("Cell1", "Cell2", "Cell3", "Cell4"))
)
seurat_obj2 <- CreateSeuratObject(counts = count_matrix, min.cells = 0, min.features = 0)
View(seurat_obj2)
# Install if not already installed
install.packages("haven")
# Load the package
library(haven)
data <- read_sav("C:/Users/z5551702/Downloads/dataverse_files/Anonymised_Respondent_data_VTT_NL2022.sav")
View(data)
load("C:/Users/z5551702/OneDrive - UNSW/Desktop/D/BackUp/MetaData_V1.Rdata")
load("C:/Users/z5551702/OneDrive - UNSW/Desktop/D/BackUp/MetaData_V1.Rdata")
########################################################### Start | Duplicate the 'imm_receptor' column as 'imm_receptor2'
full_metadata$imm_receptor2 <- full_metadata$imm_receptor
cols <- colnames(full_metadata)
i <- which(cols == "imm_receptor")
new_order <- append(cols, "imm_receptor2", after = i)
new_order <- new_order[!duplicated(new_order)]
full_metadata <- full_metadata[, new_order]
########################################################### End | Duplicate the 'imm_receptor' column as 'imm_receptor2'
########################################################### Start | Remove "ab", gd", Aberant ab" and "Aberrant g" values from imm_receptor2 in selected B cell clusters
target_clusters <- c(
"Mast cells", "Plasma cells", "B cells_1", "B cells_2", "B cells MZB1+",
"Aber. Plasma cells", "Macrophages", "Plasmablast", "B cells BAFFR", "Dendritic cells"
)
target_receptors <- c("Aberant ab", "Aberrant g", "gd", "ab")
rows_to_clean <- which(
full_metadata$cluster %in% target_clusters &
full_metadata$imm_receptor2 %in% target_receptors
)
length(rows_to_clean)
full_metadata$imm_receptor2[rows_to_clean] <- ""
########################################################### End | Remove "gd", Aberant ab" and "Aberrant g" values from imm_receptor2 in selected B cell clusters
target_clusters <- c(
"Mast cells", "Plasma cells", "B cells_1", "B cells_2", "B cells MZB1+",
"Aber. Plasma cells", "Macrophages", "Plasmablast", "B cells BAFFR", "Dendritic cells"
)
rows_to_clear <- which(
!(full_metadata$cluster %in% target_clusters) &
full_metadata$imm_receptor2 == "hkl"
)
length(rows_to_clean)
full_metadata$imm_receptor2[rows_to_clear] <- ""
length(rows_to_clear)
sum(full_metadata$imm_receptor == "T and B")
getwd()
setwd("C:/Esmaeil/CeliacProject/CeliacProject")
library(ggplot2)
library(dplyr)
plot_data <- full_metadata %>%
filter(!is.na(cluster))
cluster_centers <- plot_data %>%
group_by(cluster) %>%
summarize(x = mean(scVI_with_hvg_UMAP_1),
y = mean(scVI_with_hvg_UMAP_2))
umap_plot <- ggplot(plot_data, aes(x = scVI_with_hvg_UMAP_1,
y = scVI_with_hvg_UMAP_2,
color = factor(cluster))) +
geom_point(size = 0.6, alpha = 0.8) +
geom_text(data = cluster_centers, aes(x = x, y = y, label = cluster),
color = "black", size = 3, hjust = 0.5, vjust = 0.5) +
labs(title = "UMAP of Cells Colored by Cluster",
x = "UMAP 1",
y = "UMAP 2",
color = "Cluster") +
theme_minimal() +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.background = element_rect(fill = "white", color = NA))  # تنظیم پس‌زمینه سفید
ggsave("UMAP_plot.png", plot = umap_plot, width = 8, height = 6, dpi = 300, bg = "white")
load("C:/Esmaeil/CeliacProject/BackUp/MetaData_V1.Rdata")
colnames(full_metadata)
